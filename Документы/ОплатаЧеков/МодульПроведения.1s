//Начало текста, вставленного Инсталлятором МОД
Процедура ОбработкаПроведения() Далее
//Конец текста, вставленного Инсталлятором МОД
Процедура стар_ОбработкаПроведения()
//Закомментировано Инсталлятором МОД:Процедура ОбработкаПроведения()
	Если семМожноПровести( Контекст ) = 0 Тогда Возврат; КонецЕсли;
	ВыбратьСтроки();
	Пока ПолучитьСтроку()=1 Цикл
		Если (ВалютаРК.Тип=Перечисление.ТипыВалютРК.Наличные) ИЛИ (ВалютаРК.Тип=Перечисление.ТипыВалютРК.КредитныеКарты) ИЛИ (ВалютаРК.Тип=Перечисление.ТипыВалютРК.ПодарочныеКарты) Тогда
			// Касса
			Если ТипУчета<Фин Тогда
				Если Константа.МетодРасчетаСебестоимостиУправленческогоУчета.Выбран()=1 Тогда
					Регистр.Касса.Валюта=?(ВалютаРК.Валюта.Выбран()=1,ВалютаРК.Валюта,Рубли);
					Регистр.Касса.Касса=Касса;
					Регистр.Касса.Наличность=Пересчет(Сумма,Константа.БазоваяВалюта_R_Keeper,ДатаДок,Регистр.Касса.Валюта,ДатаДок);
					Регистр.Касса.Статья=Константа.СтатьяПриходаРК;
					Регистр.Касса.ДвижениеПриходВыполнить();
				КонецЕсли;
			КонецЕсли;
		ИначеЕсли ((ВалютаРК.Тип<>Перечисление.ТипыВалютРК.Неплательщики) И (ВалютаРК.Тип<>Перечисление.ТипыВалютРК.БезналичныеРасчеты)) Тогда
			// Взаиморасчеты  
			Продолжить;
			КлиентОплатаЧеков=ВалютаРК.Клиент;
			ПривязыватьСтроку(НомерСтроки);
			Если ТипУчета<Фин Тогда  // по Упр. учету
				// Выделим отдельно Товары и Услуги
				Если СуммаТоваров<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаТоваров,"","Упр","Товар")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
				Если СуммаУслуг<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаУслуг,"","Упр","Услуга")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			//--------------------
			Если ТипУчета>Упр Тогда  // по Фин. учету
				// Выделим отдельно Товары и Услуги по разным ставкам НДС
				Если СуммаТоваров20<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаТоваров20,Перечисление.ЗначенияНДС.ОсновнаяСтавкаНДС,"Фин","Товар")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
				Если СуммаТоваров10<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаТоваров10,Перечисление.ЗначенияНДС.ЛьготнаяСтавкаНДС,"Фин","Товар")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
				Если СуммаТоваровБезНДС<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаТоваровБезНДС,Перечисление.ЗначенияНДС.НДС0,"Фин","Товар")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
				Если СуммаУслуг20<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаУслуг20,Перечисление.ЗначенияНДС.ОсновнаяСтавкаНДС,"Фин","Услуга")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
				Если СуммаУслуг10<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаУслуг10,Перечисление.ЗначенияНДС.ЛьготнаяСтавкаНДС,"Фин","Услуга")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
				Если СуммаУслугБезНДС<>0 Тогда
					Если ПогашениеДолгаПоКредиту(Контекст,ТекущийДокумент(),СуммаУслугБезНДС,Перечисление.ЗначенияНДС.НДС0,"Фин","Услуга")=1 Тогда
						Возврат;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			КлиентОплатаЧеков=0;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры
//Начало текста, вставленного Инсталлятором МОД
Процедура ОбработкаПроведения()
	//Внимание: данная процедура при обновлении Менеджера будет перезаписана заново
	//без сохранения текущего кода !!!
	//Рекомендуем собственные алгоритмы записывать в старую процедуру с префиксом стар_
	Если ПроведениеМОД(Контекст)=1 Тогда
	    Возврат;
	КонецЕсли;
	стар_ОбработкаПроведения();
КонецПроцедуры
//Конец текста, вставленного Инсталлятором МОД
//Начало текста, вставленного Инсталлятором МОД
Процедура ОбработкаУдаленияПроведения()
	//Внимание: данная процедура при обновлении Менеджера будет перезаписана заново
	//без сохранения текущего кода !!!
	//Рекомендуем собственные алгоритмы записывать в старую процедуру с префиксом стар_
	Если ПроведениеПоАлгоритмуМОД=1 Тогда
	    Возврат;
	КонецЕсли;
	ПриИзмененииОбъекта(Контекст, ТекущийДокумент(), ДатаДок);
	ПриОтменеПроведенияДокумента(ТекущийДокумент());	
КонецПроцедуры
//Конец текста, вставленного Инсталлятором МОД

