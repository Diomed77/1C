
//Начало текста, вставленного Инсталлятором МОД
Процедура ОбработкаПроведения() Далее
//Конец текста, вставленного Инсталлятором МОД
Процедура стар_ОбработкаПроведения()

	Если ДатаНачала>ДатаКонца Тогда
		НеПроводить(Контекст,"Неверно задан дипазон акционного периода!");
		Возврат;
	КонецЕсли;	
	
	Если ГрупповаяОбработка()=1 Тогда
		Если (ДатаНачала=ДатаДок) И (НазваниеНабораПрав()<>"Администратор") Тогда
			НеПроводить(Контекст,"Нельзя устанавливать акционные скидки на текущий день!");
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	Если ПустоеЗначение(КатегорияЦены)=1 Тогда
		НеПроводить(Контекст,"Не указана категория цены!");
		Возврат;
	КонецЕсли;
	
	СпрТов = СоздатьОбъект("Справочник.Номенклатура");
	Если (ГрупповаяОбработка()=0) Тогда
	
		ВыбратьСтроки();    
		Пока ПолучитьСтроку()>0 Цикл

			// проверяем наличие товара в строке
			Если Товар.Выбран() = 0 Тогда 
				Сообщить(Шаблон("Не выбран товар в строке [НомерСтроки]"),"I");
				Продолжить; 
			КонецЕсли;
			
			СпрТов.НайтиЭлемент(Товар);
			УстановитьРеквизитСправочника(СпрТов.ТекущийЭлемент(),"ВыделитьАкц"+Фирма.Страна.Код,1,ДатаНачала);
			УстановитьРеквизитСправочника(СпрТов.ТекущийЭлемент(),"ВыделитьАкц"+Фирма.Страна.Код,0,ДатаКонца+1);
			
			Состояние("Обработано: "+НомерСтроки+"/"+КоличествоСтрок());
		КонецЦикла;
	КонецЕсли;	
		
КонецПроцедуры
//Начало текста, вставленного Инсталлятором МОД
Процедура ОбработкаПроведения()
	//Внимание: данная процедура при обновлении Менеджера будет перезаписана заново
	//без сохранения текущего кода !!!
	//Рекомендуем собственные алгоритмы записывать в старую процедуру с префиксом стар_
	Если ПроведениеМОД(Контекст)=1 Тогда
		Возврат;
	КонецЕсли;
	стар_ОбработкаПроведения();
КонецПроцедуры
//Конец текста, вставленного Инсталлятором МОД
//Начало текста, вставленного Инсталлятором МОД
Процедура ОбработкаУдаленияПроведения()
	//Внимание: данная процедура при обновлении Менеджера будет перезаписана заново
	//без сохранения текущего кода !!!
	//Рекомендуем собственные алгоритмы записывать в старую процедуру с префиксом стар_
	Если ПроведениеПоАлгоритмуМОД=1 Тогда
		Возврат;
	КонецЕсли;
	ПриИзмененииОбъекта(Контекст, ТекущийДокумент(), ДатаДок);
	ПриОтменеПроведенияДокумента(ТекущийДокумент());	
	
КонецПроцедуры
//Конец текста, вставленного Инсталлятором МОД

